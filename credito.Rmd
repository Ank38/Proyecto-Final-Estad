---
title: "proyecto"
author: "nelson"
date: "2/6/2021"
output:
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(stats)
library (dplyr)  # manipulacion datafrime
library (ggplot2) #libreria grafica
library (nortest)

```

#1
##El nivel de educación depende de la categoría de tarjeta que maneja
h0. El nivel de educación indica que tipo de tarjeta tiene el cliente
h1. El nivel de educación no influye en la categoria de tarjetas

```{r}
tabla <- table(tarjetacredito$Education_Level, tarjetacredito$Card_Category, dnn=c("Educación","Categoria tarjeta" ))
tabla
chisq.test(tabla)
0.4803<0.05
mosaicplot(tabla, main=deparse("Relación de educación y caterogia de tarjetas"), col=c("green","red","blue"))

```
podemos apreciar que de cierta manera y aplicando un poco de análisis logico, damos por hecho que tener un mejor nivel de educación, influirá en la tarjeta que le sea asignada, aunque no ocurre en todos los casos, pues muchas veces solo se necesita una tarjeta para lo básico. por lo que según nuestro analisis, se acepta la ho.


#2
#Estar casado hace que dependan más personas de ti
ho. Estar casado o en una relación marital, hace que tengas más dependientes
h1. No importa si estás en una relación, tendrás siempre dependientes.

```{r}

anova<-aov(tarjetacredito$Dependent_count~tarjetacredito$Marital_Status)
summary(anova)
Pr<-3.36e-06
Pr<0.05
ggplot(data=tarjetacredito, aes(x=Dependent_count,y=Marital_Status, color=Marital_Status ))+ geom_boxplot()+theme_replace()
```
Nos damos cuenta que las medias comunes son de 2 dependientes, sin embargo, existe otro apartado en el que prefieren no mencionar su situación marital, pero si mencionan a sus dependientes, cuya media es de 3 personas, lo que nos hace rechazar la ho. ya que al menos un grupo de medias es diferente de otro.

#3el limite de credito varía según la edad

h0. la edad del cliente no influye para el lmite de credito
h1. el limite de credito está definida por la edad del cliente

```{r}
cor.test(tarjetacredito$Customer_Age, tarjetacredito$Credit_Limit)
0.8032<0.05
plot(tarjetacredito$Customer_Age,tarjetacredito$Credit_Limit, main= "Relación entre edad y limite de credito",xlab="Edad del cliente", ylab="Limite de credito", col=c("blue", "yellow"))
```
Como bien nos arroja en la prueba de correlación, la edad del cliente, si define la cantidad de credito limite otorgado, y tiene sentido hasta cierto punto, pero en este caso gracias a un buen nivel de correlación, podemos dar certeza de que si depende una variable de otra, por lo que se afirma la h1.


#4 mientras más dependientes tenga más será el limite de credito
ho. no importa cuantos dependientes se tengan, el limite de credito no lo define esta variable
h1. mientras más dependientes se tengan, mayor será el limite de credito que el cliente necesite



```{r}
cor.test(tarjetacredito$Dependent_count, tarjetacredito$Credit_Limit)
7.049e-12<0.05
plot(tarjetacredito$Dependent_count,tarjetacredito$Credit_Limit, main= "Relación entre edad y limite de credito",xlab="Edad del cliente", ylab="Limite de credito", col=c("blue", "yellow"))
```
El hecho de que un cliente tenga más dependientes que otro, no es un indicador claro de que vaya a tener más limite de credito, ya que sus necesidades pueden ser otras, por lo que se acepta la ho.

#5 normalidad en los datos de años de relación con el banco
```{r}

ad.test(tarjetacredito$Months_on_book)
shapiro.test(tarjetacredito$Months_on_book[0:5000])
hist(tarjetacredito$Months_on_book)
mbancosanios<-(mean(tarjetacredito$Months_on_book))
abline(v=mbancosanios, col="yellow")

```


#6 las mujeres tienen mejor limite de credito
ho. las mujeres pueden tener mejor credito que los hombres
h1. ambos generos pueden optar a un mejor limite de credito

```{r}
anova<-aov(tarjetacredito$Credit_Limit~tarjetacredito$Gender)
summary(anova)
2e-16<0.05
ggplot(data=tarjetacredito, aes(x=Credit_Limit,y=Gender, color=Gender ))+ geom_boxplot()+theme_replace()
```
Una lógica un tanto antigua en tiempos actuales, es pensar que las mujeres puden tener mejor limite de credito por el hecho de que les gusta comprar mucha ropa, calzado, o simplemente los alimentos, pero gracias a este pequeño análisis, nos damos cuenta que no es así, sin embargo, existen muchos datos que están dispersos en el genero de las mujeres, dandonos que pensar, de momento, se rechaza la ho, dandonos como conclusión que ambos generos pueden optar a un buen limite de credito


#7
ho.hombres y mujeres tienen las mismas posibilidades de un nivel de educación bueno
h1.si eres hombre o mujer, tendrás mejor nivel educativo
```{r}
tabla <- table(tarjetacredito$Gender, tarjetacredito$Education_Level, dnn=c("Genero","Nivel de estudios" ))
tabla
chisq.test(tabla)
0.295<0.05
mosaicplot(tabla, main=deparse("Nivel de estudios de mujeres y hombres"), col=c("green","red","blue","white","gray","brown","cyan"))
```
Tanto hombres como mujeres pueden tener un buen nivel de educación, lo que nos indica que estas variables son totalmente independientes del genero que el cliente tenga. por lo que se acepta la ho.

#8 los ingresos definen la categoria de tarjeta
h0.los ingresos del cliente, sirven para determinar la categoria de tarjeta que posee
h1.el cliente con mejores ingresos, tendrá opcion a una mejor categoría de tarjeta
```{r}
tabla <- table(tarjetacredito$Income_Category, tarjetacredito$Card_Category, dnn=c("Categoria de ingresos","Categoria tarjeta" ))
tabla
chisq.test(tabla)
1.211e-14<0.05
mosaicplot(tabla, main=deparse("Relación de categoria de ingresos y caterogia de tarjetas"), col=c("green","red","blue"))
```

gracias al analisis anterior, podemos decir que en efecto, tener mejores ingresos, ayuda a que el cliente tenga opción a una mejor categoría de tarjetas, siendo las personas con ingresos menores a 40k el grupo más grande al usar una tarjeta blue, por ende rechazamos la ho.


#9 promedio de saldo disponible de compra a través de la categoría de la tarjeta


```{r}
anova<- aov(tarjetacredito$Avg_Open_To_Buy~tarjetacredito$Card_Category)
summary(anova)
2e-16<0.05
ggplot(data=tarjetacredito, aes(x=Avg_Open_To_Buy,y=Card_Category, color=Card_Category ))+ geom_boxplot()+theme_replace()

```

#10 depende de la edad, así va a ser el gasto
```{r}
cor(tarjetacredito$Customer_Age,tarjetacredito$Avg_Open_To_Buy)
plot(tarjetacredito$Customer_Age,tarjetacredito$Avg_Open_To_Buy, main= "Relación entre edad y promedio de compra disponible",xlab="Edad del cliente", ylab="Compra disponible", col=c("blue", "yellow"))
```
#11
normalidad de los datos de la cantidad de suicidios
```{r}
ad.test(suicidios$suicides_no)
 2.2e-16<0.05
 hist(suicidios$suicides_no)
 msuicidios<-(mean(suicidios$suicides_no))
abline(v=msuicidios, col="yellow")
```
#12
ho. cada rango de edad es independiente de la generación a la que pertenecen
h1. La edad de cada individuo, define la generación en la que nació
```{r}
generaciones <- table(suicidios$age, suicidios$generation, dnn=c("Edad","Generacion" ))
generaciones
chisq.test(generaciones)
2.2e-16<0.05
mosaicplot(generaciones, main=deparse("Relación de las edades pertenecientes a cada generación"), col=c("green","red","blue"))

```
Damos por hecho que la edad en efecto define al individuo en la generación que le tocó nacer, por lo que se rechaza la ho.
